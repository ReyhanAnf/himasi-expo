<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portofolio Kegiatan HIMASI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow: hidden;
            cursor: default;
        }

        video::-webkit-media-controls { display: none !important; }

        #background-video {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: 1;
            object-fit: cover;
            transition: opacity 1s ease-in-out;
            opacity: 0;
        }

        .video-background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2;
        }
        
        #webgl-canvas {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 3;
        }

        #cursor-light {
            position: fixed;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0) 60%);
            pointer-events: none;
            z-index: 3;
            transition: transform 0.1s linear;
            transform: translate(-50%, -50%);
        }

        .content-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding-bottom: 25vh;
            align-items: center;
            text-align: center;
            padding-left: 2rem;
            padding-right: 2rem;
            z-index: 4;
            transition: opacity 1s ease-in-out;
        }

        .text-content .char, .text-content p {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .text-content.visible .char {
            opacity: 1;
            transform: translateY(0);
        }
        
        .text-content.visible p {
            opacity: 1;
            transform: translateY(0);
            transition-delay: 0.8s;
        }

        .portfolio-nav button {
            transition: all 0.3s ease;
            position: relative;
        }
        .portfolio-nav button.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 3px;
            background-color: #3b82f6;
            border-radius: 99px;
        }
        
        .progress-bar-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
        }

        .parallax-layer {
            transition: transform 0.2s linear;
        }

        #secret-button {
            position: fixed;
            bottom: 15px;
            right: 15px;
            width: 5px;
            height: 5px;
            background-color: rgba(59, 130, 246, 0.5);
            border-radius: 50%;
            z-index: 50;
            transition: all 0.3s ease;
            opacity: 0.5;
        }
        #secret-button:hover {
            transform: scale(4);
            background-color: rgba(255, 255, 255, 1);
            box-shadow: 0 0 15px #fff;
            opacity: 1;
        }
        
        #volume-toggle {
            position: fixed;
            bottom: 15px;
            left: 15px;
            width: 40px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        #volume-toggle:hover {
            background-color: rgba(0, 0, 0, 0.8);
            transform: scale(1.1);
        }

    </style>
</head>
<body class="bg-gray-900 text-white">

    <video autoplay loop playsinline id="background-video">
    </video>
    
    <div class="video-background-overlay"></div>
    <canvas id="webgl-canvas"></canvas>
    <div id="cursor-light"></div>
    
    <button id="volume-toggle" title="Nyalakan/Matikan Suara"></button>
    
    <a href="https://docs.google.com/forms/d/e/1FAIpQLScySqwPOHRsgRD5y4i0o2i3Li8ayRtgf6N9I1kevp82dgh93w/viewform?usp=dialog" target="_blank" id="secret-button" title="Tombol Rahasia Ditemukan! Klik untuk hadiah!">&nbsp;</a>

    <div id="video-container" class="content-overlay">
        <div id="text-content" class="text-content max-w-3xl">
            <div class="parallax-layer" data-parallax-strength="20">
                <h1 id="video-title" class="text-3xl md:text-5xl font-black uppercase tracking-wider mb-4"></h1>
            </div>
            <div class="parallax-layer" data-parallax-strength="10">
                <p id="video-description" class="mt-4 text-base md:text-lg text-gray-300"></p>
            </div>
        </div>

        <div id="playlist" class="portfolio-nav absolute bottom-10 flex items-center justify-center space-x-6 md:space-x-8"></div>
        
        <div id="loader" class="absolute inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50">
            <svg class="animate-spin h-10 w-10 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
        </div>
        
        <div class="progress-bar-container">
            <div id="progress-bar" class="bg-blue-500 h-full" style="width: 0%;"></div>
        </div>
    </div>

    <script>
        window.addEventListener('load', () => {
            initializeAppLogic();
            
            function initializeAppLogic() {
                const backgroundVideoUrl = "./video.mp4";
                
                const contentDataList = [
                    { id: 1, title: "HIMASI UBSI TASIKMALAYA", description: "Mengupas tren teknologi terkini blablabla" },
                    { id: 2, title: "KELAS REGULER", description: "Sesi praktik langsung untuk meningkatkan keterampilan pemrograman dan pengembangan aplikasi." },
                    { id: 3, title: "BAKTI SOSIAL TA'JIL", description: "Berbagi dan mengabdi kepada masyarakat sebagai wujud kepedulian sosial mahasiswa." },
                    { id: 4, title: "KELAS CODING", description: "Belajar Bersama untuk menggali lebih dalam tentang pemograman dan pengembangan aplikasi." },
                    { id: 5, title: "MALAM KEAKRABAN", description: "Mempererat tali persaudaraan antar anggota dan alumni dari Himpunan Mahasiswa Sistem Informasi Universitas Bina Sarana Informatika Tasikmalaya dalam suasana yang hangat dan santai." },
                    { id: 6, title: "TEMUKAN TOMBOL TERSEMBUNYI UNTUK DAPAT HADIAH", description: "Temukan tombol rahasia di halaman ini. Pemenang pertama yang mengisi formulir akan mendapatkan hadiah spesial dari kami!" },
                ];
                let currentContentIndex = 0;
                let autoChangeInterval;

                const video = document.getElementById('background-video');
                const videoTitle = document.getElementById('video-title');
                const videoDescription = document.getElementById('video-description');
                const textContent = document.getElementById('text-content');
                const playlistContainer = document.getElementById('playlist');
                const loader = document.getElementById('loader');
                const progressBar = document.getElementById('progress-bar');
                const parallaxLayers = document.querySelectorAll('.parallax-layer');
                const cursorLight = document.getElementById('cursor-light');
                const volumeToggle = document.getElementById('volume-toggle');
                
                const mutedIcon = `
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                </svg>`;
                const unmutedIcon = `
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
                </svg>`;
                
                video.muted = false;
                volumeToggle.innerHTML = mutedIcon;
                
                volumeToggle.addEventListener('click', (e) => {
                    e.stopPropagation();
                    video.muted = !video.muted;
                    volumeToggle.innerHTML = video.muted ? unmutedIcon : mutedIcon;
                });

                function updateContent(index) {
                    const contentData = contentDataList[index];
                    currentContentIndex = index;
                    textContent.classList.remove('visible');
                    
                    setTimeout(() => {
                        videoTitle.innerHTML = '';
                        contentData.title.split('').forEach((char, i) => {
                            const span = document.createElement('span');
                            span.className = 'char inline-block';
                            span.textContent = char === ' ' ? '\u00A0' : char;
                            span.style.transitionDelay = `${i * 0.05}s`;
                            videoTitle.appendChild(span);
                        });
                        videoDescription.textContent = contentData.description;
                        updateNavActiveState();
                        textContent.classList.add('visible');
                    }, 500);
                }

                function startAutoChange() {
                    clearInterval(autoChangeInterval);
                    autoChangeInterval = setInterval(() => {
                        const nextIndex = (currentContentIndex + 1) % contentDataList.length;
                        updateContent(nextIndex);
                    }, 7000); 
                }

                function generateNav() {
                    playlistContainer.innerHTML = '';
                    contentDataList.forEach((item, index) => {
                        const button = document.createElement('button');
                        button.className = "text-sm font-semibold uppercase tracking-widest text-gray-400 hover:text-white";
                        button.textContent = String(index + 1).padStart(2, '0');
                        button.dataset.index = index;
                        button.addEventListener('click', (e) => {
                            e.stopPropagation();
                            if (index !== currentContentIndex) {
                                updateContent(index);
                                startAutoChange();
                            }
                        });
                        playlistContainer.appendChild(button);
                    });
                    updateNavActiveState();
                }
                
                function updateNavActiveState() {
                    document.querySelectorAll('.portfolio-nav button').forEach((item, index) => {
                        if (index === currentContentIndex) {
                            item.classList.add('active', 'text-white');
                            item.classList.remove('text-gray-400');
                        } else {
                            item.classList.remove('active', 'text-white');
                            item.classList.add('text-gray-400');
                        }
                    });
                }
                
                video.addEventListener('timeupdate', () => { progressBar.style.width = `${(video.currentTime / video.duration) * 100}%`; });
                video.addEventListener('canplay', () => { 
                    loader.style.display = 'none'; 
                    video.style.opacity = '1'; 
                    updateContent(0); 
                    startAutoChange();
                    video.play().catch(error => {
                        console.log("Autoplay dengan suara diblokir, mengaktifkan mode mute.", error);
                        video.muted = true;
                        video.play();
                        volumeToggle.innerHTML = unmutedIcon;
                    });
                });
                video.addEventListener('waiting', () => { loader.style.display = 'flex'; });
                
                let scene, camera, renderer, particles, lines;
                let mouse = new THREE.Vector2(-100, -100);
                
                function initWebGL() {
                    const canvas = document.getElementById('webgl-canvas');
                    scene = new THREE.Scene();
                    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                    camera.position.z = 50;
                    renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    renderer.setPixelRatio(window.devicePixelRatio);
                    const particlesGeometry = new THREE.BufferGeometry();
                    const particlesCount = 200;
                    const posArray = new Float32Array(particlesCount * 3);
                    for(let i = 0; i < particlesCount * 3; i++) { posArray[i] = (Math.random() - 0.5) * 100; }
                    particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
                    const particlesMaterial = new THREE.PointsMaterial({ size: 0.3, color: 0x3b82f6 });
                    particles = new THREE.Points(particlesGeometry, particlesMaterial);
                    scene.add(particles);
                    const linesGeometry = new THREE.BufferGeometry();
                    const maxLines = particlesCount * particlesCount;
                    const linesPosition = new Float32Array(maxLines * 3);
                    linesGeometry.setAttribute('position', new THREE.BufferAttribute(linesPosition, 3));
                    const linesMaterial = new THREE.LineBasicMaterial({ color: 0x3b82f6, transparent: true, opacity: 0.15 });
                    lines = new THREE.LineSegments(linesGeometry, linesMaterial);
                    scene.add(lines);
                    window.addEventListener('resize', onWindowResize, false);
                    document.addEventListener('mousemove', onMouseMove, false);
                }
                
                function onWindowResize() {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                }
                
                function onMouseMove(event) {
                    const mouseX = event.clientX / window.innerWidth * 2 - 1;
                    const mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
                    mouse.x = mouseX;
                    mouse.y = mouseY;
                    cursorLight.style.left = `${event.clientX}px`;
                    cursorLight.style.top = `${event.clientY}px`;
                    parallaxLayers.forEach(layer => {
                        const strength = layer.dataset.parallaxStrength || 10;
                        const parallaxX = -mouseX * strength;
                        const parallaxY = -mouseY * strength;
                        layer.style.transform = `translate3d(${parallaxX}px, ${parallaxY}px, 0)`;
                    });
                }
                
                function animateWebGL() {
                    requestAnimationFrame(animateWebGL);
                    particles.rotation.y += 0.0002;
                    particles.rotation.x += 0.0002;
                    const positions = particles.geometry.attributes.position.array;
                    const linePositions = lines.geometry.attributes.position.array;
                    let lineCount = 0;
                    const interactionDistance = 10;
                    const vector = new THREE.Vector3(mouse.x, mouse.y, 0.5);
                    vector.unproject(camera);
                    const dir = vector.sub(camera.position).normalize();
                    const distance = -camera.position.z / dir.z;
                    const mouseWorld = camera.position.clone().add(dir.multiplyScalar(distance));
                    for (let i = 0; i < positions.length; i += 3) {
                        const p1 = new THREE.Vector3(positions[i], positions[i+1], positions[i+2]);
                        if (p1.distanceTo(mouseWorld) < interactionDistance) {
                            for (let j = i + 3; j < positions.length; j += 3) {
                                const p2 = new THREE.Vector3(positions[j], positions[j+1], positions[j+2]);
                                if (p1.distanceTo(p2) < interactionDistance) {
                                    linePositions[lineCount * 3] = p1.x; linePositions[lineCount * 3 + 1] = p1.y; linePositions[lineCount * 3 + 2] = p1.z; lineCount++;
                                    linePositions[lineCount * 3] = p2.x; linePositions[lineCount * 3 + 1] = p2.y; linePositions[lineCount * 3 + 2] = p2.z; lineCount++;
                                }
                            }
                        }
                    }
                    for(let i = lineCount * 3; i < linePositions.length; i++) { linePositions[i] = 0; }
                    lines.geometry.setDrawRange(0, lineCount);
                    lines.geometry.attributes.position.needsUpdate = true;
                    renderer.render(scene, camera);
                }

                generateNav();
                video.src = backgroundVideoUrl;
                initWebGL();
                animateWebGL();
            }
        });
    </script>
</body>
</html>

